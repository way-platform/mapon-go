edition = "2023";

package wayplatform.connect.mapon.v1;

import "google/protobuf/timestamp.proto";
import "wayplatform/connect/mapon/v1/common.proto";
import "wayplatform/connect/mapon/v1/movement_status.proto";

option go_package = "github.com/way-platform/mapon-go/proto/gen/go/wayplatform/connect/mapon/v1;maponv1";

// UnitState represents the dynamic telemetry data of a unit at a specific point in time.
// This message is used for both the current state of a unit and historical snapshots (e.g., route start/end).
message UnitState {
  // Timestamp of the state update.
  google.protobuf.Timestamp time = 1;

  // Geographical location of the unit.
  Location location = 2;

  // Current speed in kilometers per hour.
  int32 speed_kmh = 3;

  // Direction of movement in degrees (0-360).
  int32 direction_deg = 4;

  // Total distance travelled by the unit in meters (odometer).
  // API documentation refers to this as "mileage" or "odometer" in meters.
  int64 odometer_m = 5;

  // Total time the ignition has been on in seconds.
  int64 ignition_total_duration_s = 6;

  // Current movement status.
  MovementStatus movement_status = 7;

  // The raw string value of the movement status if it is not one of the known MovementStatus enum values.
  // This field is populated only when 'movement_status' is MOVEMENT_STATUS_UNRECOGNIZED.
  string unrecognized_movement_status = 13;

  // Fuel level in liters.
  // Note: If unit's consumption is kg/100km, this might represent kg.
  double fuel_level_l = 8;

  // Supply voltage in volts.
  double supply_voltage_v = 9;

  // Battery voltage in volts.
  double battery_voltage_v = 10;

  // Timestamp when this state started (e.g., when the unit started moving or standing).
  google.protobuf.Timestamp start_time = 11;

  // Duration of this state in seconds.
  int64 duration_s = 12;

  // Altitude in meters.
  double altitude_m = 14;

  // Gross combination weight in kilograms.
  double gross_combination_weight_kg = 15;

  // EV Battery State of Charge (Relative) in percent (0-100).
  double battery_soc_percent = 16;

  // EV Battery State of Charge (Absolute) in kWh.
  double battery_soc_kwh = 17;

  // Charging state (true if charging).
  bool charging_state = 18;

  // AdBlue level fraction (0-1).
  double adblue_level_fraction = 19;

  // Total fuel used lifetime in liters.
  double total_fuel_used_lifetime_l = 20;

  // Timestamp when supply voltage was last updated.
  google.protobuf.Timestamp supply_voltage_time = 21;

  // Timestamp when battery voltage was last updated.
  google.protobuf.Timestamp battery_voltage_time = 22;

  // Current ignition state (true if on).
  bool ignition_state = 23;

  // Timestamp when ignition state was last updated.
  google.protobuf.Timestamp ignition_time = 24;

  // Ambient temperature in Celsius.
  double ambient_temperature_c = 25;

  // Timestamp when ambient temperature was last updated.
  google.protobuf.Timestamp ambient_temperature_time = 26;

  // Debug message from state debug_info.
  string debug_message = 27;

  // CAN odometer timestamp.
  google.protobuf.Timestamp can_odometer_time = 28;

  // CAN fuel total timestamp.
  google.protobuf.Timestamp can_fuel_total_time = 29;

  // CAN engine RPM.
  double can_engine_rpm = 30;

  // Timestamp when CAN engine RPM was last updated.
  google.protobuf.Timestamp can_engine_rpm_time = 31;

  // CAN fuel level in liters.
  double can_fuel_level_l = 32;

  // Timestamp when CAN fuel level was last updated.
  google.protobuf.Timestamp can_fuel_level_time = 33;

  // CAN engine hours.
  double can_engine_hours_h = 34;

  // Timestamp when CAN engine hours was last updated.
  google.protobuf.Timestamp can_engine_hours_time = 35;

  // Axis weights (axis number -> weight data).
  map<int32, AxisWeight> axis_weights = 36;

  // Powered weight in kilograms.
  double powered_weight_kg = 37;

  // Timestamp when powered weight was last updated.
  google.protobuf.Timestamp powered_weight_time = 38;

  // Timestamp when combination weight was last updated.
  google.protobuf.Timestamp combination_weight_time = 39;

  // Fuel entries with detailed information.
  repeated FuelEntry fuel_entries = 40;

  // Timestamp when altitude was last updated.
  google.protobuf.Timestamp altitude_time = 41;

  // EV charger connected state (true if connected).
  bool ev_charger_connected = 42;

  // Timestamp when EV charger connected state was last updated.
  google.protobuf.Timestamp ev_charger_connected_time = 43;

  // Timestamp when EV charging state was last updated.
  google.protobuf.Timestamp ev_charging_time = 44;

  // Timestamp when EV battery SOC percent was last updated.
  google.protobuf.Timestamp battery_soc_percent_time = 45;

  // Timestamp when EV battery SOC kWh was last updated.
  google.protobuf.Timestamp battery_soc_kwh_time = 46;

  // CAN Service Brake Switch (true if active).
  bool can_service_brake_switch = 47;

  // Timestamp when CAN Service Brake Switch was last updated.
  google.protobuf.Timestamp can_service_brake_switch_time = 48;

  // CAN Parking Brake Switch (true if active).
  bool can_parking_brake_switch = 49;

  // Timestamp when CAN Parking Brake Switch was last updated.
  google.protobuf.Timestamp can_parking_brake_switch_time = 50;

  // CAN Engine Load in percent.
  double can_engine_load_percent = 51;

  // Timestamp when CAN Engine Load was last updated.
  google.protobuf.Timestamp can_engine_load_time = 52;

  // AxisWeight represents weight data for a specific axis.
  message AxisWeight {
    // Weight value in kilograms.
    double weight_kg = 1;

    // Timestamp when the weight was measured.
    google.protobuf.Timestamp time = 2;
  }

  // FuelEntry represents a fuel level entry with metadata.
  message FuelEntry {
    // Fuel type (e.g., "CAN").
    string type = 1;

    // Metrics unit (e.g., "L", "KG", "pct").
    string metrics = 2;

    // Fuel value.
    double value = 3;

    // Timestamp when the fuel level was last updated.
    google.protobuf.Timestamp last_update = 4;
  }
}
